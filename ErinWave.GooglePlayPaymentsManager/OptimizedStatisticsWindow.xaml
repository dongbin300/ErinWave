<Window x:Class="ErinWave.GooglePlayPaymentsManager.OptimizedStatisticsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ErinWave.GooglePlayPaymentsManager"
        mc:Ignorable="d"
        Title="ê²°ì œ í†µê³„" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- í—¤ë” -->
        <Border Grid.Row="0" Background="#4285F4" Padding="20" CornerRadius="8" Margin="0,0,0,15">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="ðŸ“Š" FontSize="32" Margin="0,0,15,0" VerticalAlignment="Center"/>
                <StackPanel VerticalAlignment="Center">
                    <TextBlock Text="Google Play ê²°ì œ í†µê³„" FontSize="24" FontWeight="Bold" Foreground="White"/>
                    <TextBlock x:Name="PeriodText" Text="ê¸°ê°„: ê³„ì‚° ì¤‘..." FontSize="14" Foreground="#E8F0FE" Margin="0,5,0,0"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- ìš”ì•½ ì •ë³´ -->
        <Border Grid.Row="1" Background="#F8F9FA" Padding="20" CornerRadius="8" Margin="0,0,0,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="ì´ ì§€ì¶œì•¡" FontWeight="Bold" FontSize="12" Foreground="#5F6368"/>
                    <TextBlock x:Name="TotalSpentText" Text="â‚©0" FontSize="18" FontWeight="Bold" Foreground="#EA4335"/>
                </StackPanel>

                <StackPanel Grid.Column="1">
                    <TextBlock Text="ê±°ëž˜ íšŸìˆ˜" FontWeight="Bold" FontSize="12" Foreground="#5F6368"/>
                    <TextBlock x:Name="TransactionCountText" Text="0íšŒ" FontSize="18" FontWeight="Bold" Foreground="#4285F4"/>
                </StackPanel>

                <StackPanel Grid.Column="2">
                    <TextBlock Text="í‰ê·  ê²°ì œì•¡" FontWeight="Bold" FontSize="12" Foreground="#5F6368"/>
                    <TextBlock x:Name="AverageAmountText" Text="â‚©0" FontSize="18" FontWeight="Bold" Foreground="#34A853"/>
                </StackPanel>

                <StackPanel Grid.Column="3">
                    <TextBlock Text="ê°€ìž¥ ë§Žì´ ì†Œë¹„í•œ ë‹¬" FontWeight="Bold" FontSize="12" Foreground="#5F6368"/>
                    <TextBlock x:Name="MostExpensiveMonthText" Text="ê³„ì‚° ì¤‘..." FontSize="14" FontWeight="Bold" Foreground="#FBBC04"/>
                </StackPanel>

                <StackPanel Grid.Column="4">
                    <TextBlock Text="ê°€ìž¥ ë§Žì´ ì†Œë¹„í•œ ë‚ " FontWeight="Bold" FontSize="12" Foreground="#5F6368"/>
                    <TextBlock x:Name="MostExpensiveDayText" Text="ê³„ì‚° ì¤‘..." FontSize="14" FontWeight="Bold" Foreground="#FBBC04"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ì¶”ê°€ ìš”ì•½ ì •ë³´ (ê²Œìž„ë³„) -->
        <Border Grid.Row="1" Background="#F3E5F5" Padding="15" CornerRadius="8" Margin="0,80,0,15">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <TextBlock Text="ðŸŽ®" FontSize="20" Margin="0,0,10,0" VerticalAlignment="Center"/>
                <StackPanel>
                    <TextBlock Text="ê°€ìž¥ ë§Žì´ ì†Œë¹„í•œ ê²Œìž„" FontWeight="Bold" FontSize="12" Foreground="#5F6368"/>
                    <TextBlock x:Name="MostSpentGameText" Text="ê³„ì‚° ì¤‘..." FontSize="16" FontWeight="Bold" Foreground="#9C27B0"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- ë¡œë”© ì¸ë””ì¼€ì´í„° -->
        <Grid Grid.Row="2" x:Name="LoadingPanel" Background="White" Visibility="Collapsed">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="300" Height="20" Margin="0,0,0,15"
                             Foreground="#4285F4" Background="#E8F0FE"/>
                <TextBlock Text="í†µê³„ ë°ì´í„° ê³„ì‚° ì¤‘..." HorizontalAlignment="Center"
                           FontSize="16" FontWeight="Bold" Foreground="#5F6368"/>
                <TextBlock x:Name="LoadingStatusText" Text="0% ì™„ë£Œ" HorizontalAlignment="Center"
                           FontSize="14" Foreground="#80868B" Margin="0,5,0,0"/>
            </StackPanel>
        </Grid>

        <!-- íƒ­ê³¼ ë‚´ìš© -->
        <TabControl Grid.Row="2" x:Name="StatisticsTabControl" Background="Transparent">
            <!-- ì¼ë³„ í†µê³„ -->
            <TabItem Header="ì¼ë³„ í†µê³„" FontSize="14" FontWeight="Bold">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="ë‚ ì§œë³„ ì§€ì¶œ í˜„í™©" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                        <Button x:Name="RefreshDailyButton" Content="ìƒˆë¡œê³ ì¹¨" Margin="20,0,0,0" Padding="10,5"
                                Background="#4285F4" Foreground="White" BorderThickness="0" Click="RefreshDailyButton_Click"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" x:Name="DailyStatisticsGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#E0E0E0"
                              AlternatingRowBackground="#F8F9FA"
                              FontSize="12">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ë‚ ì§œ" Binding="{Binding Date}" Width="120" IsReadOnly="True"/>
                            <DataGridTextColumn Header="ê±°ëž˜ íšŸìˆ˜" Binding="{Binding TransactionCount}" Width="100" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="ì´ì•¡" Binding="{Binding FormattedTotal}" Width="120" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#EA4335"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="í‰ê· " Binding="{Binding FormattedAverage}" Width="120" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#34A853"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- ì›”ë³„ í†µê³„ -->
            <TabItem Header="ì›”ë³„ í†µê³„" FontSize="14" FontWeight="Bold">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="ì›”ë³„ ì§€ì¶œ í˜„í™©" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                        <Button x:Name="RefreshMonthlyButton" Content="ìƒˆë¡œê³ ì¹¨" Margin="20,0,0,0" Padding="10,5"
                                Background="#4285F4" Foreground="White" BorderThickness="0" Click="RefreshMonthlyButton_Click"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" x:Name="MonthlyStatisticsGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#E0E0E0"
                              AlternatingRowBackground="#F8F9FA"
                              FontSize="12">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ë…„ì›”" Binding="{Binding DisplayText}" Width="150" IsReadOnly="True"/>
                            <DataGridTextColumn Header="ê±°ëž˜ íšŸìˆ˜" Binding="{Binding TransactionCount}" Width="100" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="ì´ì•¡" Binding="{Binding FormattedTotal}" Width="150" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#EA4335"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="í‰ê· " Binding="{Binding FormattedAverage}" Width="150" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#34A853"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- ì—°ë³„ í†µê³„ -->
            <TabItem Header="ì—°ë³„ í†µê³„" FontSize="14" FontWeight="Bold">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="ì—°ê°„ ì§€ì¶œ í˜„í™©" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                        <Button x:Name="RefreshYearlyButton" Content="ìƒˆë¡œê³ ì¹¨" Margin="20,0,0,0" Padding="10,5"
                                Background="#4285F4" Foreground="White" BorderThickness="0" Click="RefreshYearlyButton_Click"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" x:Name="YearlyStatisticsGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#E0E0E0"
                              AlternatingRowBackground="#F8F9FA"
                              FontSize="12">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ì—°ë„" Binding="{Binding Year}" Width="100" IsReadOnly="True"/>
                            <DataGridTextColumn Header="ê±°ëž˜ íšŸìˆ˜" Binding="{Binding TransactionCount}" Width="120" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="ì´ì•¡" Binding="{Binding FormattedTotal}" Width="150" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#EA4335"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="í‰ê· " Binding="{Binding FormattedAverage}" Width="150" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#34A853"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="ì›”í‰ê· " Binding="{Binding FormattedMonthlyAverage}" Width="150" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#FBBC04"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- ê²Œìž„ë³„ í†µê³„ -->
            <TabItem Header="ðŸŽ® ê²Œìž„ë³„ í†µê³„" FontSize="14" FontWeight="Bold">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="ê²Œìž„ë³„ ì§€ì¶œ í˜„í™©" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                        <Button x:Name="RefreshGameButton" Content="ìƒˆë¡œê³ ì¹¨" Margin="20,0,0,0" Padding="10,5"
                                Background="#9C27B0" Foreground="White" BorderThickness="0" Click="RefreshGameButton_Click"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" x:Name="GameStatisticsGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#E0E0E0"
                              AlternatingRowBackground="#F8F9FA"
                              FontSize="12">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ê²Œìž„ëª…" Binding="{Binding GameName}" Width="300" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="TextWrapping" Value="Wrap"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="ê±°ëž˜ íšŸìˆ˜" Binding="{Binding TransactionCount}" Width="100" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="ì´ì•¡" Binding="{Binding FormattedTotal}" Width="150" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#EA4335"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="í‰ê· " Binding="{Binding FormattedAverage}" Width="150" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#34A853"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="ë¹„ìœ¨" Binding="{Binding FormattedPercentage}" Width="100" IsReadOnly="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#9C27B0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- í•˜ë‹¨ ë²„íŠ¼ -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button x:Name="ExportButton" Content="ë‚´ë³´ë‚´ê¸°" Padding="15,8" Margin="0,0,10,0"
                    Background="#34A853" Foreground="White" BorderThickness="0" FontWeight="Bold"
                    Click="ExportButton_Click"/>
            <Button x:Name="CloseButton" Content="ë‹«ê¸°" Padding="15,8"
                    Background="#5F6368" Foreground="White" BorderThickness="0" FontWeight="Bold"
                    Click="CloseButton_Click"/>
        </StackPanel>
    </Grid>
</Window>